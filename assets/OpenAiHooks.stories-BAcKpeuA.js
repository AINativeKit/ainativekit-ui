var O=Object.defineProperty;var D=(t,o,n)=>o in t?O(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n;var b=(t,o,n)=>D(t,typeof o!="symbol"?o+"":o,n);import{j as e}from"./jsx-runtime-DF2Pcvd1.js";import{r}from"./index-B2-qRKKC.js";import{B as c}from"./Button-Dng2PzYd.js";import{C as R,a as L,b as P,c as z}from"./Card-Dc6H-pJz.js";import"./ImageCard-D9AzDWPM.js";import"./SummaryCard-CMET0rie.js";import"./ListCard-Ctbi2qeC.js";import"./DiscoveryCard-CH3SMBzS.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./Badge-BePEr_L6.js";import"./Chip-DUrCjCup.js";import"./Alert-Dd8CbNX0.js";import"./Features-DcYKce8P.js";const m="openai:set_globals";class j extends CustomEvent{constructor(n){super(m,{detail:n});b(this,"type",m)}}function d(t){return r.useSyncExternalStore(o=>{if(typeof window>"u")return()=>{};const n=i=>{i.detail.globals[t]!==void 0&&o()};return window.addEventListener(m,n,{passive:!0}),()=>{window.removeEventListener(m,n)}},()=>{var o;return((o=window==null?void 0:window.openai)==null?void 0:o[t])??null},()=>null)}function B(t){const o=d("toolOutput"),n=typeof t=="function"?t():t??null;return o??n}function G(t){const o=d("widgetState"),[n,i]=r.useState(()=>o??(typeof t=="function"?t():t??null));r.useEffect(()=>{i(o)},[o]);const p=r.useCallback(s=>{i(u=>{var a,x;const l=typeof s=="function"?s(u):s;return l!=null&&((x=(a=window==null?void 0:window.openai)==null?void 0:a.setWidgetState)==null||x.call(a,l)),l})},[]);return[n,p]}const I=()=>d("maxHeight"),T=()=>d("displayMode"),A=()=>{if(typeof window>"u")return null;if(!window.openai){const t={theme:"light",userAgent:{device:{type:"desktop"},capabilities:{hover:!0,touch:!1}},locale:"en-US",maxHeight:480,displayMode:"inline",safeArea:{insets:{top:0,bottom:0,left:0,right:0}},toolInput:{},toolOutput:{message:"Hello from host"},toolResponseMetadata:null,widgetState:{count:0},setWidgetState:async o=>{typeof window>"u"||!window.openai||(Object.assign(window.openai,{widgetState:o}),window.dispatchEvent(new j({globals:{widgetState:o}})))},callTool:async(o,n)=>({result:`Mocked callTool(${o}) with args: ${JSON.stringify(n)}`}),sendFollowUpMessage:async()=>{},openExternal:()=>{},requestDisplayMode:async({mode:o})=>(typeof window<"u"&&window.openai&&(Object.assign(window.openai,{displayMode:o}),window.dispatchEvent(new j({globals:{displayMode:o}}))),{mode:o})};window.openai=t}return window.openai},g=t=>{if(typeof window>"u")return;const o=A();o&&(Object.assign(o,t),window.dispatchEvent(new j({globals:t})))},$=t=>{const o=r.useRef(null);r.useEffect(()=>{A()},[]),r.useEffect(()=>{const n={insets:{top:t.safeAreaTop,bottom:t.safeAreaBottom,left:t.safeAreaLeft,right:t.safeAreaRight}};g({theme:t.openaiTheme,displayMode:t.displayMode,maxHeight:t.maxHeight,locale:t.locale,safeArea:n,toolOutput:{message:t.toolMessage}})},[t.displayMode,t.maxHeight,t.locale,t.openaiTheme,t.safeAreaBottom,t.safeAreaLeft,t.safeAreaRight,t.safeAreaTop,t.toolMessage]),r.useEffect(()=>{o.current!==t.initialWidgetCount&&(o.current=t.initialWidgetCount,g({widgetState:{count:t.initialWidgetCount}}))},[t.initialWidgetCount])},_=()=>{const t=()=>{var s;const n=((s=window.openai)==null?void 0:s.displayMode)??"inline",i=["inline","pip","fullscreen"],p=i[(i.indexOf(n)+1)%i.length];g({displayMode:p})},o=()=>{g({toolOutput:{message:`Host says hello @ ${new Date().toLocaleTimeString()}`}})};return e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",padding:"12px",background:"var(--ai-color-bg-secondary)",border:"1px solid var(--ai-color-border-default)",borderRadius:"12px"},children:[e.jsx(c,{variant:"primary",onClick:t,children:"Cycle Display Mode"}),e.jsx(c,{variant:"tertiary",onClick:o,children:"Push Host Tool Message"})]})},K=()=>{const t=T(),n=(i=>{switch(i){case"inline":return"100%";case"pip":return"300px";case"fullscreen":return"600px";default:return"100%"}})(t);return e.jsx("div",{style:{maxWidth:n,transition:"max-width 0.3s ease"},children:e.jsx(R,{interactive:!0,elevationLevel:"2",children:e.jsxs(L,{children:[e.jsx(P,{children:"Live Hook Demonstration"}),e.jsx(z,{children:"This card's width changes based on display mode"}),e.jsxs("div",{style:{marginTop:"16px",display:"grid",gap:"12px",gridTemplateColumns:"repeat(2, 1fr)"},children:[e.jsxs("div",{style:{padding:"12px",backgroundColor:"var(--ai-color-bg-secondary)",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"12px",color:"var(--ai-color-text-secondary)",marginBottom:"6px"},children:"Display Mode"}),e.jsx("div",{style:{fontSize:"16px"},children:t||"—"})]}),e.jsxs("div",{style:{padding:"12px",backgroundColor:"var(--ai-color-bg-secondary)",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"12px",color:"var(--ai-color-text-secondary)",marginBottom:"6px"},children:"Card Width"}),e.jsx("div",{style:{fontSize:"16px"},children:n})]})]}),e.jsx("p",{style:{margin:"16px 0 0 0",fontSize:"14px",color:"var(--ai-color-text-secondary)"},children:"Try cycling display modes to see the card width change!"})]})})})},U=({initialWidgetCount:t})=>{const o=T(),n=I(),i=d("locale"),p=d("theme"),s=d("safeArea"),u=B(()=>({message:""})),[l,a]=G(()=>({count:t})),x=(l==null?void 0:l.count)??0,W=r.useMemo(()=>{if(!s)return null;const{top:y,right:f,bottom:v,left:E}=s.insets;return`${y}px / ${f}px / ${v}px / ${E}px`},[s]),w=y=>{a(f=>({count:Math.max(0,((f??{count:0}).count??0)+y)}))},k=()=>{a({count:t})},H=()=>{a({count:0})};return e.jsxs("div",{style:{display:"grid",gap:"16px",padding:"16px",border:"1px solid var(--ai-color-border-default)",borderRadius:"12px",background:"var(--ai-color-bg-surface, var(--ai-color-bg-primary))"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 8px",fontSize:"18px"},children:"Hook Readout"}),e.jsxs("dl",{style:{display:"grid",gridTemplateColumns:"160px 1fr",gap:"6px 12px",margin:0},children:[e.jsx("dt",{children:"Theme"}),e.jsx("dd",{children:p??"—"}),e.jsx("dt",{children:"Locale"}),e.jsx("dd",{children:i??"—"}),e.jsx("dt",{children:"Display Mode"}),e.jsx("dd",{children:o??"—"}),e.jsx("dt",{children:"Max Height"}),e.jsx("dd",{children:n??"—"}),e.jsx("dt",{children:"Safe Area (TRBL)"}),e.jsx("dd",{children:W??"—"}),e.jsx("dt",{children:"Tool Output Message"}),e.jsx("dd",{children:(u==null?void 0:u.message)||"—"}),e.jsx("dt",{children:"Widget Count"}),e.jsx("dd",{children:x})]})]}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"4px"},children:[e.jsx(c,{variant:"primary",onClick:()=>w(1),children:"Increment Count"}),e.jsx(c,{variant:"secondary",onClick:()=>w(-1),disabled:x===0,children:"Decrement Count"}),e.jsx(c,{variant:"tertiary",onClick:k,children:"Reset to Initial"}),e.jsx(c,{variant:"ghost",onClick:H,children:"Clear (null)"})]})]})},F=t=>($(t),e.jsxs("div",{style:{display:"grid",gap:"20px",maxWidth:"760px",margin:"0 auto",padding:"24px"},children:[e.jsxs("section",{style:{marginBottom:"12px"},children:[e.jsx("h1",{style:{margin:"0 0 12px",fontSize:"28px",fontWeight:"700"},children:"🪝 OpenAI Hooks Playground"}),e.jsx("p",{style:{margin:"0 0 8px 0",color:"var(--ai-color-text-secondary)",fontSize:"16px",lineHeight:"1.5"},children:"These hooks give you access to the ChatGPT Apps SDK environment, allowing your component to react to host events, manage state, and communicate with the ChatGPT host."}),e.jsx("p",{style:{margin:"0 0 8px 0",color:"var(--ai-color-text-secondary)",fontSize:"14px"},children:e.jsx("strong",{children:"Available hooks:"})}),e.jsxs("ul",{style:{margin:"0",paddingLeft:"20px",color:"var(--ai-color-text-secondary)",fontSize:"14px"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"useOpenAiGlobal()"})," - Access global SDK properties (theme, locale, display mode, etc.)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"useWidgetState()"})," - Manage your widget state that persists across host updates"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"useWidgetProps()"})," - Get tool input/output from the host"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"useDisplayMode()"})," - React to display mode changes (inline, pip, fullscreen)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"useMaxHeight()"})," - Constrain your component to the available height"]})]})]}),e.jsxs("section",{style:{marginTop:"24px",paddingTop:"20px",borderTop:"1px solid var(--ai-color-border-default)"},children:[e.jsx("h2",{style:{margin:"0 0 12px",fontSize:"20px",fontWeight:"600"},children:"🎮 Interactive Playground"}),e.jsx("p",{style:{margin:"0 0 12px",color:"var(--ai-color-text-secondary)",fontSize:"14px"},children:"Try adjusting the controls below or using the Storybook controls panel to simulate host environment changes and see how the hooks respond in real-time."}),e.jsx(_,{}),e.jsx(U,{initialWidgetCount:t.initialWidgetCount})]}),e.jsx("section",{children:e.jsx(K,{})})]})),re={title:"Hooks/ChatGPT SDK Integration",render:t=>e.jsx(F,{...t}),parameters:{layout:"fullscreen",controls:{expanded:!0}},args:{openaiTheme:"light",displayMode:"inline",maxHeight:480,locale:"en-US",toolMessage:"Hello from the host environment 👋",initialWidgetCount:1,safeAreaTop:12,safeAreaBottom:24,safeAreaLeft:0,safeAreaRight:0},argTypes:{openaiTheme:{control:{type:"inline-radio"},options:["light","dark"]},displayMode:{control:{type:"inline-radio"},options:["inline","pip","fullscreen"]},locale:{control:{type:"text"}},toolMessage:{control:{type:"text"}},maxHeight:{control:{type:"number",min:200,max:1200,step:20}},initialWidgetCount:{control:{type:"number",min:0,max:10,step:1}},safeAreaTop:{control:{type:"number",min:0,max:64,step:1}},safeAreaBottom:{control:{type:"number",min:0,max:64,step:1}},safeAreaLeft:{control:{type:"number",min:0,max:64,step:1}},safeAreaRight:{control:{type:"number",min:0,max:64,step:1}}}},h={};var S,C,M;h.parameters={...h.parameters,docs:{...(S=h.parameters)==null?void 0:S.docs,source:{originalSource:"{}",...(M=(C=h.parameters)==null?void 0:C.docs)==null?void 0:M.source}}};const ae=["Playground"];export{h as Playground,ae as __namedExportsOrder,re as default};
